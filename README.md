# Адаптация LDPC-кодов для квантовой криптографии

## Описание проекта

Решение задачи адаптивного выбора параметров LDPC-кодов для системы коррекции ошибок в квантовой криптографии. Алгоритм автоматически подбирает оптимальные параметры кода `{R, s, p}` на основе характеристик квантового канала и состояния аппаратуры.

**Команда:** MOLOCHKO (Leo, Alexander, Denis)

## Задача

Разработать модель ИИ, которая для каждого фрейма данных выбирает параметры LDPC-кода:
- **R** - скорость кода (0.5, 0.55, ..., 0.9)
- **s** - количество сокращенных узлов
- **p** - количество проколотых узлов

### Цели оптимизации:
- Минимизация итераций BP-декодера
- Сокращение объема служебной информации
- Уменьшение дополнительных раундов коррекции ошибок

## Установка и зависимости

```bash
pip install numpy pandas scikit-learn lightgbm joblib
```

## Использование
### Быстрый запуск (с предобученной моделью):

```bash
python AIDAOAgent.py --input frames_errors.csv --out submission.csv
```

### Обучение новой модели:

```bash
python AIDAOAgent.py --input frames_errors.csv --out submission.csv --train
```

### Расширенные опции:

```bash
python AIDAOAgent.py \
    --input frames_errors.csv \
    --out submission.csv \
    --teacher teacher_sample.csv \
    --train \
    --debug \
    --start_block 1489460492 \
    --start_frame 99 \
    --end_block 1840064900 \
    --end_frame 101
```

## Архитектура решения
### 1. Feature Engineering
- Временные признаки: лаги (1-64), скользящие средние (4-128), экспоненциальное сглаживание
- Физические взаимодействия: произведения ключевых параметров
- Статистические метрики: волатильность, интерквартильный размах
- Отношения сигналов: hit ratios, соотношения различных состояний

### 2. Модель машинного обучения
- Алгоритм: LightGBM с групповой кросс-валидацией
- Целевая переменная: E_mu_Z_est (оценка уровня ошибок)
- Валидация: GroupKFold по блокам данных

### 3. Выбор параметров кода
- R: агрессивный выбор на основе бинарной энтропии с запасом 1.5%
- s: адаптивный выбор с учетом волатильности канала
- p: вычисляется как 4800 - s

### 4. Калибровка
- Изотоническая регрессия для калибровки предсказаний
- Квантельная регрессия для нелинейных зависимостей
- Кусочная калибровка по образцу teacher-файла

## Структура данных
### Входные данные (CSV):
```bash
block_id, frame_idx, E_mu_Z, E_mu_phys_est, E_mu_X, E_nu1_X, E_nu2_X, 
E_nu1_Z, E_nu2_Z, N_mu_X, M_mu_XX, M_mu_XZ, M_mu_X, N_mu_Z, M_mu_ZZ, 
M_mu_Z, N_nu1_X, M_nu1_XX, M_nu1_XZ, M_nu1_X, N_nu1_Z, M_nu1_ZZ, 
M_nu1_Z, N_nu2_X, M_nu2_XX, M_nu2_XZ, M_nu2_X, N_nu2_Z, M_nu2_ZZ, 
M_nu2_Z, nTot, unitsRatio, bayesImVoltage, opticalPower, 
polarizerVoltages[0-3], temp_1, biasVoltage_1, temp_2, biasVoltage_2, 
synErr, N_EC_rounds, maintenance_flag, estimator_name, f_EC, E_mu_Z_est, R, s, p
```

### Выходные данные (CSV):
```bash
E_mu_Z, R, s, p
```

## Ключевые особенности
### Агрессивная оптимизация
- Сниженный коэффициент безопасности (1.10 вместо 1.12)
- Уменьшенный запас прочности (1.5% вместо 2%)
- Агрессивное смещение предсказаний для ускорения сходимости

### Адаптивность
- Учет волатильности канала при выборе параметров
- Динамическая корректировка на основе стабильности сигнала
- Гибкая калибровка под конкретные условия аппаратуры

### Устойчивость
- Ансамблирование предсказаний (медиана по фолдам)
- Защита от выбросов и артефактов измерений
- Робастная обработка пропущенных значений

### Метрики оценки
- Public метрика: длина секретного ключа на открытых данных
- Private метрика: общая длина ключа на всех данных
- Эффективность коррекции: количество успешных раундов декодирования

### Ограничения
- Режим мягкого реального времени
- Требуется интеграция с симулятором LDPC-декодера
- Фиксированный размер фрейма: 32,000 бит (27,200 + 4,800)
